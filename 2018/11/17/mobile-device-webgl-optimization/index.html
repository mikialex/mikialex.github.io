<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>移动设备 WebGL 优化 | mikialex</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="移动设备的GPU性能限制主要体现在两个方面：着色器计算和带宽，所以移动设备的 webgl 优化也主要围绕这两个方面进行。减少带宽使用关于带宽的问题，我的理解是，为了让设备发挥最大性能，肯定是需要处理器满载的，满载需要有源源不断的数据从存储运进去，同时把结果运回存储，如果你的处理器很强，但是带宽不够，那就无法发挥性能，或者说如果你的程序需要大量的访问数据，那么在带宽上就很容易形成瓶颈。带宽的瓶颈在桌"><meta property="og:type" content="article"><meta property="og:title" content="移动设备 WebGL 优化"><meta property="og:url" content="http://mikialex.github.io/2018/11/17/mobile-device-webgl-optimization/index.html"><meta property="og:site_name" content="mikialex"><meta property="og:description" content="移动设备的GPU性能限制主要体现在两个方面：着色器计算和带宽，所以移动设备的 webgl 优化也主要围绕这两个方面进行。减少带宽使用关于带宽的问题，我的理解是，为了让设备发挥最大性能，肯定是需要处理器满载的，满载需要有源源不断的数据从存储运进去，同时把结果运回存储，如果你的处理器很强，但是带宽不够，那就无法发挥性能，或者说如果你的程序需要大量的访问数据，那么在带宽上就很容易形成瓶颈。带宽的瓶颈在桌"><meta property="og:locale" content="default"><meta property="og:updated_time" content="2020-08-23T07:00:50.628Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="移动设备 WebGL 优化"><meta name="twitter:description" content="移动设备的GPU性能限制主要体现在两个方面：着色器计算和带宽，所以移动设备的 webgl 优化也主要围绕这两个方面进行。减少带宽使用关于带宽的问题，我的理解是，为了让设备发挥最大性能，肯定是需要处理器满载的，满载需要有源源不断的数据从存储运进去，同时把结果运回存储，如果你的处理器很强，但是带宽不够，那就无法发挥性能，或者说如果你的程序需要大量的访问数据，那么在带宽上就很容易形成瓶颈。带宽的瓶颈在桌"><link rel="icon" href="/favicon.png"><link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,700|Inconsolata|Oswald" rel="stylesheet"><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"></head><body><div class="site-wrapper is_post_page"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="b">A</span> <span class="b">R</span> <span class="b">T</span> <span class="w">I</span> <span class="w">F</span> <span class="b">A</span> <span class="b">C</span> <span class="b">T</span> </a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-mobile-device-webgl-optimization" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">移动设备 WebGL 优化</h1><div class="article-meta">Posted on <time class="article-time" datetime="2018-11-16T16:00:00.000Z" itemprop="datePublished">Nov 17, 2018</time></div></header><div class="article-entry" itemprop="articleBody"><p>移动设备的GPU性能限制主要体现在两个方面：着色器计算和带宽，所以移动设备的 webgl 优化也主要围绕这两个方面进行。</p><h4 id="减少带宽使用"><a href="#减少带宽使用" class="headerlink" title="减少带宽使用"></a>减少带宽使用</h4><p>关于带宽的问题，我的理解是，为了让设备发挥最大性能，肯定是需要处理器满载的，满载需要有源源不断的数据从存储运进去，同时把结果运回存储，如果你的处理器很强，但是带宽不够，那就无法发挥性能，或者说如果你的程序需要大量的访问数据，那么在带宽上就很容易形成瓶颈。带宽的瓶颈在桌面平台还好，移动设备就非常明显。距离来说带宽最大的，是独立显卡，独立的显存和图形处理器之间的数据交换可以达到几百GB每秒，然后是核显，会弱一些，最弱的是移动设备，显示数据是共享设备的内存的，高带宽的使用甚至会影响整个soc的性能表现。</p><p>在webgl应用中可以通过不同方法减少带宽使用。</p><p>1 在webgl canvas合成期间保证没有额外的副本和操作存在，context的获取设置中。preserveDrawingBuffer总是false。alpha不需要就不开。</p><p>2 尽可能减少材质和帧缓存的分辨率。如果材质都是一些低频的内容，降低分辨率并不会在视觉上造成显著影响。现在移动设备，屏幕分辨率都非常高，小小的手机屏幕的像素数量甚至超过桌面屏幕， 所以牺牲显示效果，减少帧缓存的分辨率也能起到作用。</p><p>3尽可能的减少后处理的步骤，最好压缩成一个，最好没有后处理。</p><p>关于 preserveDrawingBuffer：webgl 的canvas使用双缓冲区进行工作，preserveDrawingBuffer 默认是关的，就是正常的双缓冲工作模式： 一个用来显示，一个用来绘制，下一帧这两个buffer会交换，显示上一帧绘制的，画上一帧用来显示的。如果 preserveDrawingBuffer 设置为 true，那么就不会发生交换，而是把上一帧绘制的buffer，复制到显示的buffer一遍，在带宽上具有很大开销。 preserveDrawingBuffer也并不是没用的东西，比如如果需要读取像素，或者复用绘制到主屏幕上的图像，比如实现脏矩形渲染优化，那么就非开不可。</p><h4 id="优化着色器执行"><a href="#优化着色器执行" class="headerlink" title="优化着色器执行"></a>优化着色器执行</h4><p>通过将shader替换成最简单的shader，可以立刻确认webgl应用的性能瓶颈是否在shader执行上。具体的shader优化是一门大学问，这里只提几个通用的点。关于着色器优化我想我会在其他文中集中总结。</p><p>1.退而求其次，使用简单的着色和光照模型。这一点就不多说了，就是牺牲效果换取性能。</p><p>2.在 CPU 端对drawcall进行深度排序，缓解 overdraw。 但是要注意的是，这可能将渲染的瓶颈转移到CPU端，除了排序本身的成本，另外主要是不恰当的排序会导致gl状态不必要的切换。drawcall 排序也是一门学问，关于drawcall排序的内容应该也需要单独总结。</p><p>3.降低shader精度，但是有没有效果，完全取决于具体硬件。</p></div><div class="article-tags"></div></article><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div>&copy; mikialex Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div><div>Powered by <a href="https://hexo.io/" rel="external">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></div><div class="site-sidebar"><div class="sidebar-switch clearfix" style="display:none"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-toc" style="display:none"><div class="no-index">No Index</div></div><div class="site-bio show" style="display:block"><div class="about-me clearfix"><div class="avatar"><img src="/img/avatar.png"></div><div class="info"><a class="name dark-btn" href="/about">miki alex</a></div><div class="info"><span class="item desc"></span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="https://github.com/mikialex" class="github" target="_blank" rel="external"><span class="icon icon-github"></span></a></div></div><div class="shortcuts"><a href="#header" class="top window-nav dark-btn" id="go-top"><span class="icon icon-chevron-thin-up"></span> </a><a class="close dark-btn" id="sidebar-close"><span class="icon icon-close"></span> </a><a href="#footer" class="top window-nav dark-btn" id="go-bottom"><span class="icon icon-chevron-thin-down"></span></a></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="",AZURE_INDEX_NAME="",AZURE_QUERY_KEY="",BAIDU_API_ID="",SEARCH_SERVICE="google",universalSearchConfig={};"google"===SEARCH_SERVICE?universalSearchConfig={searchService:SEARCH_SERVICE,apiKey:GOOGLE_CUSTOM_SEARCH_API_KEY,engineId:GOOGLE_CUSTOM_SEARCH_ENGINE_ID,imagePath:"/img/"}:"algolia"===SEARCH_SERVICE?universalSearchConfig={searchService:SEARCH_SERVICE,apiKey:ALGOLIA_API_KEY,appId:ALGOLIA_APP_ID,indexName:ALGOLIA_INDEX_NAME,imagePath:"/img/"}:"azure"===SEARCH_SERVICE&&(universalSearchConfig={searchService:SEARCH_SERVICE,serviceName:AZURE_SERVICE_NAME,indexName:AZURE_INDEX_NAME,apiKey:AZURE_QUERY_KEY,imagePath:"/img/"})</script><script src="https://code.jquery.com/jquery-2.1.4.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script>document.getElementById("loading-bar").style.width="100%"</script></body></html>